<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Code Scanner</title>
</head>
<body>
    <button onclick="redirectToPage('Homepage.html')">Homepage</button>
    <br> <br> <br>
    <button onclick="takeAttendance()">Attendance By UID</button>
    <input type="text" name="uid" id="uid">

    <br> <br>
    <button onclick="redirectToPage('QR-Attendance.html')">Attendance By QR</button>

</body>

<script>

function redirectToPage(page) {
            window.location.href = page;
        }


        function takeAttendance(){
            let uidValue=document.getElementById("uid").value;
            console.log(uidValue);
            sendToAPI(uidValue)
        }


        function getCurrentTimeStamp() {
                // Get the current date and time
                const currentDate = new Date();

                // Format the date and time as per your requirement
                const formattedDate = `${currentDate.getDate().toString().padStart(2, '0')}-${(currentDate.getMonth() + 1).toString().padStart(2, '0')}-${currentDate.getFullYear()} ${currentDate.getHours().toString().padStart(2, '0')}:${currentDate.getMinutes().toString().padStart(2, '0')}:${currentDate.getSeconds().toString().padStart(2, '0')}`;

                return formattedDate;
    }

        

        function sendToAPI(uuid) {
                const apiUrl = 'http://localhost:8080/api/attendance';

                fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                      userUUID: uuid,
                      attendanceDate:getCurrentTimeStamp()
                    }),
                })
                .then(response => response.json())
                .then(data => {
                    console.log('API Response:', data);
                    alert('attendance taken')
                })
                .catch(error => {
                    console.error('Error sending data to API:', error);
                });
            }



</script>
</html>
